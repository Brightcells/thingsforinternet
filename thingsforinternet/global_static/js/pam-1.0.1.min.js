var config={site:"",usr:"",cache:"true",device:"C",img_index:0,slide_image_num:5,slide_image_classify:"",global_bg_time:0,global_bg_res:[],pic_jsonp_url:"http://pamjs.com/api/pic/?site=%1&usr=%2&num=%3&callback=pamjs&cache=%4&device=%5&classify=%6",daily_pic_jsonp_url:"http://pamjs.com/api/daily_pic/?site=%1&usr=%2&num=%3&callback=pamjs&cache=%4&device=%5&classify=%6",ctrl:true,con_div:"Div",display:false};function init(a){for(c in a){if(c in config){config[c]=a[c]}}}function browserCheck(){var a={},b=navigator.userAgent.toLowerCase(),d;(d=b.match(/msie ([\d.]+)/))?a.ie=d[1]:(d=b.match(/firefox\/([\d.]+)/))?a.firefox=d[1]:(d=b.match(/chrome\/([\d.]+)/))?a.chrome=d[1]:(d=b.match(/opera.([\d.]+)/))?a.opera=d[1]:(d=b.match(/version\/([\d.]+).*safari/))?a.safari=d[1]:0;return a}Date.prototype.pattern=function(a){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()==0?12:this.getHours(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},d={"0":"\u65e5","1":"\u4e00","2":"\u4e8c","3":"\u4e09","4":"\u56db","5":"\u4e94","6":"\u516d"};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}if(/(E+)/.test(a)){a=a.replace(RegExp.$1,((RegExp.$1.length>1)?(RegExp.$1.length>2?"\u661f\u671f":"\u5468"):"")+d[this.getDay()+""])}for(var b in e){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(e[b]):(("00"+e[b]).substr((""+e[b]).length)))}}return a};String.format=function(d){var a=arguments,b=new RegExp("%([1-"+a.length+"])","g");return String(d).replace(b,function(e,f){return a[f]})};function setOneOrMore(a){config.global_bg_res=a[0];if(1==config.global_bg_res.length){setBackground(config.global_bg_res[0])}else{timeId=window.setInterval("slideSetBackground(config.global_bg_res)",config.global_bg_time);slideSetBackground(config.global_bg_res)}}var pamjs=function(e){setOneOrMore(e);if(window.localStorage){var d=new Date().pattern("yyyy-MM-dd");for(var b=0;b<localStorage.length;b++){var a=localStorage.key(0);if(a.indexOf(d)>=0){}else{localStorage.removeItem(a)}}localStorage.setItem(String.format("%1_%2_%3_%4",config.site,config.usr,config.slide_image_classify,d),JSON.stringify(e))}};function getRemoteInfo(f,e,i,d,b,h,g){var a=document.createElement("script");a.setAttribute("src",String.format(f,e,i,d,b,h,g));document.getElementsByTagName("head")[0].appendChild(a)}function _bg(e,b,d){if(1==e){var a=String.format("%1_%2_%3_%4",config.site,config.usr,config.slide_image_classify,new Date().pattern("yyyy-MM-dd"));if(window.localStorage&&(a in localStorage)){setOneOrMore(JSON.parse(localStorage.getItem(a)))}else{if(1==b){config.global_bg_time=d;getRemoteInfo(config.pic_jsonp_url,config.site,config.usr,config.slide_image_num,config.cache,config.device,config.slide_image_classify)}else{if(-1==b){getRemoteInfo(config.dailypic_jsonp_url,config.site,config.usr,config.slide_image_num,config.cache,config.device,config.slide_image_classify)}else{config.global_bg_time=d;getRemoteInfo(config.pic_jsonp_url,config.site,config.usr,1,config.cache,config.device,config.slide_image_classify)}}}}else{if(1==b.length){setBackground(b[0])}else{config.global_bg_res=b;var f=window.setInterval("slideSetBackground(config.global_bg_res)",d);slideSetBackground(config.global_bg_res)}}}function slideSetBackground(a){if(config.img_index>=a.length){config.img_index=0}setBackground(a[config.img_index++])}function setBackground(d){var g=d.image,e=d.info,a=d.link;var h=document.getElementById("_bgImg");if(h){h.src=g}else{var f=document.createElement("div");f.id="bgDiv";f.className="bgDiv";var b=document.body.appendChild(f);var h=document.createElement("img");h.id="_bgImg";h.src=g;var b=f.appendChild(h)}if(undefined==e||""==e){var i=document.getElementById("infoDiv");if(i){i.parentNode.removeChild(i)}}else{var i=document.getElementById("infoDiv");if(i){if(undefined!=a){document.getElementById("aInfo").href=a}document.getElementById("aInfo").innerHTML=e}else{var i=document.createElement("div");i.id="infoDiv";i.className="infoDiv";var b=document.body.appendChild(i);_h3Title=document.createElement("h3");_h3Title.className="h3Title";_h3Title.innerHTML="今日图片故事";var b=i.appendChild(_h3Title);_aInfo=document.createElement("a");_aInfo.id="aInfo";_aInfo.className="aInfo";if(undefined!=a){_aInfo.href=a;_aInfo.target="_blank"}_aInfo.innerHTML=e;var b=i.appendChild(_aInfo)}}}function _audio(a,e){var d=browserCheck();if(1==a){var b=[url+"audio/snq",url+"audio/qg",url+"audio/xy"];if(d.ie&&parseInt(d.ie.split(".")[0])<9){_audio_IE(b)}else{if(1==e){broadcastList(b)}else{var f=parseInt(Math.random()*b.length);broadcastList(b.slice(f,f+1))}}}else{if(d.ie&&parseInt(d.ie.split(".")[0])<9){_audio_IE(e)}else{broadcastList(e)}}}function broadcastList(f){var e=0;var b=document.createElement("audio");if(b!=null&&b.canPlayType){var d=document.body.appendChild(b);broadcast(b,f[e++]);b.addEventListener("ended",function(){if(e>=f.length){e=0}broadcast(b,f[e++])},false)}else{var a=document.createElement("div");a.innerText="您现在使用的浏览器不支持audio标签";var d=document.body.appendChild(a)}}function broadcast(a,b){a.id="_audio";a.controls="controls";a.preload="auto";a.autoplay="autoplay";a.className="audio";if(a.canPlayType("audio/ogg")){a.src=b+".ogg"}else{if(a.canPlayType("audio/mpeg")){a.src=b+".mp3"}}}function _audio_IE(d){var a=document.createElement("div");var b=document.body.appendChild(a);var f=document.createElement("a");a.appendChild(f);f.id="_switch";f.href="javascript:void(0);";f.onclick=function(g){var h=document.getElementById("_bgsound");if("关闭背景音乐"==document.getElementById("_switch").innerHTML){h.src="";f.innerText="打开背景音乐"}else{h.src=d[0]+".mp3";f.innerText="关闭背景音乐"}};f.innerText="关闭背景音乐";f.className="switch";var e=document.createElement("bgsound");e.id="_bgsound";e.src=d[0]+".mp3";e.loop=-1;var b=document.body.appendChild(e)}function _movie(b,f){var a=browserCheck();if(1==b){var d=[url+"movie/movie",url+"movie/xwqzzhxcp"];if(a.ie&&parseInt(a.ie.split(".")[0])<9){_movie_IE(f)}else{if(1==f){broadcastSetList(d)}else{var e=parseInt(Math.random()*d.length);broadcastSetList(d.slice(e,e+1))}}}else{if(a.ie&&parseInt(a.ie.split(".")[0])<9){_movie_IE(f)}else{broadcastSetList(f)}}}function broadcastSetList(g){var f=0;var b=document.createElement("video");if(b!=null&&b.canPlayType){var e=document.createElement("div");e.className="movieDiv";var d=document.body.appendChild(e);var d=e.appendChild(b);broadcastSet(b,g[f++]);b.addEventListener("ended",function(){if(f>=g.length){f=0}broadcastSet(b,g[f++])},false)}else{var a=document.createElement("div");a.innerText="您现在使用的浏览器不支持video标签";var d=document.body.appendChild(a)}}function broadcastSet(a,b){a.id="_movie";a.preload="auto";a.autoplay="autoplay";if(a.canPlayType("video/mp4")){a.src=b+".mp4"}else{if(a.canPlayType("video/ogg")){a.src=b+".ogv"}else{if(a.canPlayType("video/webM")){a.src=b+".webm"}}}}function _movie_IE(e){var a=document.createElement("div");a.className="ieMovieDiv";var b=document.body.appendChild(a);var d=document.createElement("embed");d.id="_embed";d.src=e[0]+".avi";d.autostart=true;d.loop=true;d.className="ieEmbed";var b=a.appendChild(d)}function showid(p,m,o){var b=(document.all)?true:false;var e=b&&([/MSIE (\d)\.0/i.exec(navigator.userAgent)][0][1]==6);var f=document.getElementById(p);f.style.zIndex="9999";f.style.display="block";f.style.position=!e?"fixed":"absolute";f.style.top=f.style.left="50%";f.style.marginTop=-f.offsetHeight/2+"px";f.style.marginLeft=-f.offsetWidth/2+"px";if(null==document.getElementById("_img")){var k=document.createElement("img");k.id="_img";k.src=m;k.className="imgStyle";f.appendChild(k);var j=document.createElement("br");f.appendChild(j);var l=document.createElement("b");l.innerHTML=o;f.appendChild(l)}var h=document.createElement("div");h.id="layer";h.style.width=h.style.height="100%";h.style.position=!e?"fixed":"absolute";h.style.top=h.style.left=0;h.style.backgroundColor="#000";h.style.zIndex="9998";h.style.opacity="0.6";document.body.appendChild(h);var a=document.getElementsByTagName("select");for(var g=0;g<a.length;g++){a[g].style.visibility="hidden"}function n(){h.style.width=Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth)+"px";h.style.height=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)+"px"}function d(){f.style.marginTop=document.documentElement.scrollTop-f.offsetHeight/2+"px";f.style.marginLeft=document.documentElement.scrollLeft-f.offsetWidth/2+"px"}if(b){h.style.filter="alpha(opacity=60)"}if(e){n();d();window.attachEvent("onscroll",function(){d()});window.attachEvent("onresize",n)}h.onclick=function(){f.style.display="none";h.style.display="none";for(var q=0;q<a.length;q++){a[q].style.visibility="visible"}}}window.onload=function(){if(config.ctrl){var d=document.getElementById(config.con_div);if(d){var b=document.createElement("span");b.id="ctrlSpan";b.className="ctrlSpan";if(config.display&&d){d.style.display="";b.innerHTML="隐藏"}else{d.style.display="none";b.innerHTML="显示"}var a=document.body.appendChild(b);b.addEventListener("click",function(){if(""==d.style.display){d.style.display="none";b.innerHTML="显示"}else{d.style.display="";b.innerHTML="隐藏"}},false)}}};